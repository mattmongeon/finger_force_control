#include "stopwatch.h"
#include "utils.h"


////////////////////////////////////////////////////////////////////////////////
//  Construction / Destruction
////////////////////////////////////////////////////////////////////////////////

cStopwatch::cStopwatch()
	: mPrevElapsedTime_ms(0),
	  mStarted(false)
{

}

////////////////////////////////////////////////////////////////////////////////
//  Interface Functions
////////////////////////////////////////////////////////////////////////////////

void cStopwatch::Start()
{
	if( !mStarted )
	{
		mStarted = true;
		mStartTime = nUtils::GetSysTime_ms();
	}
}

////////////////////////////////////////////////////////////////////////////////

void cStopwatch::Stop()
{
	if( mStarted )
	{
		mPrevElapsedTime_ms += nUtils::GetSysTime_ms() - mStartTime;
	}
	
	mStarted = false;
}

////////////////////////////////////////////////////////////////////////////////

void cStopwatch::Reset()
{
	mPrevElapsedTime_ms = 0.0;
	mStartTime = nUtils::GetSysTime_ms();
}

////////////////////////////////////////////////////////////////////////////////

void cStopwatch::StopAndReset()
{
	Stop();
	Reset();
}

////////////////////////////////////////////////////////////////////////////////

double cStopwatch::GetElapsedTime_ms() const
{
	double retVal = mPrevElapsedTime_ms;
	if( mStarted )
	{
		retVal += nUtils::GetSysTime_ms() - mStartTime;
	}
	
	return retVal;
}

